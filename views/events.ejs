<%- include('partials/header') %>

    <div class="container py-4">
        <h1 class="page-title text-center w-100 mb-5" data-aos="fade-down">
            <%= t.events_title %>
        </h1>

        <div class="row">
            <% events.forEach((event, index)=> { %>
                <div class="col-md-4 mb-4" data-aos="flip-up" data-aos-delay="<%= index * 100 %>">
                    <div class="card h-100 border-0 shadow-lg overflow-hidden event-card">
                        <div class="position-relative">
                            <img src="<%= event.image %>" class="card-img-top" alt="<%= event.title %>"
                                onerror="this.src='https://source.unsplash.com/400x300/?church,celebration'"
                                style="height: 250px; object-fit: cover;">
                            <div
                                class="position-absolute top-0 end-0 bg-warning text-dark px-3 py-1 rounded-bottom-start fw-bold shadow-sm">
                                <%= new Date(event.date).toLocaleDateString('en-US', { month: 'short' , day: 'numeric'
                                    }) %>
                            </div>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h4 class="card-title fw-bold text-primary">
                                <%= event.title %>
                            </h4>
                            <p class="text-muted small mb-2"><i class="far fa-clock me-2"></i>
                                <%= event.date %>
                            </p>
                            <p class="card-text text-secondary block-clamp">
                                <%= event.description %>
                            </p>

                            <div class="mt-auto">
                                <button class="btn btn-outline-primary w-100 mt-2 rounded-pill fw-bold"
                                    data-bs-toggle="modal" data-bs-target="#eventModal<%= event.id %>">
                                    <i class="fas fa-info-circle me-1"></i>
                                    <%= t.view_details %>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal for this event -->
                <div class="modal fade" id="eventModal<%= event.id %>" tabindex="-1" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content border-0 shadow-lg">
                            <div class="modal-header bg-gradient-brand text-white border-0"
                                style="background: var(--gradient-primary);">
                                <h5 class="modal-title fw-bold">
                                    <%= event.title %>
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body p-0">
                                <img src="<%= event.image %>" class="img-fluid w-100"
                                    style="height: 250px; object-fit: cover;" alt="<%= event.title %>">
                                <div class="p-4">
                                    <h6 class="text-muted fw-bold mb-3">
                                        <i class="far fa-calendar-alt me-2 text-warning"></i>
                                        <%= new Date(event.date).toLocaleDateString('en-US', { weekday: 'long' ,
                                            year: 'numeric' , month: 'long' , day: 'numeric' }) %>
                                    </h6>
                                    <p class="lead fs-6">
                                        <%= event.description %>
                                    </p>
                                    <p class="mb-0 mt-3 small text-muted">Join us in celebration and fellowship. All are
                                        welcome!</p>
                                </div>
                            </div>
                            <div class="modal-footer border-0 bg-light">
                                <button type="button" class="btn btn-secondary rounded-pill px-4"
                                    data-bs-dismiss="modal">
                                    <%= t.close %>
                                </button>
                                <a href="/contact" class="btn btn-primary rounded-pill px-4">
                                    <%= t.contact %>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <% }) %>
        </div>
    </div>

    <style>
        .block-clamp {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .event-card:hover {
            transform: translateY(-5px);
            transition: transform 0.3s ease;
        }
    </style>

    <%- include('partials/footer') %>